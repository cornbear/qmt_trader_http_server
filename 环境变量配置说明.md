# ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜

**ç‰ˆæœ¬**: v1.2.0  
**åŠŸèƒ½**: æ”¯æŒä» .env æ–‡ä»¶è¯»å–é…ç½®

---

## ğŸ¯ åŠŸèƒ½è¯´æ˜

QMTäº¤æ˜“å®¢æˆ·ç«¯ç°åœ¨æ”¯æŒä» `.env` æ–‡ä»¶è¯»å–é…ç½®å‚æ•°ï¼Œé¿å…åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯ã€‚

### ä¼˜åŠ¿

- âœ… **å®‰å…¨æ€§**: æ•æ„Ÿä¿¡æ¯ä¸ä¼šå‡ºç°åœ¨ä»£ç ä¸­
- âœ… **çµæ´»æ€§**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®
- âœ… **ä¾¿æ·æ€§**: ä¸€æ¬¡é…ç½®ï¼Œå¤„å¤„ä½¿ç”¨
- âœ… **ç‰ˆæœ¬æ§åˆ¶å‹å¥½**: .env æ–‡ä»¶ä¸ä¼šè¢«æäº¤åˆ°Git

---

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
# å®‰è£… python-dotenv
pip install python-dotenv

# æˆ–è€…ä» requirements.txt å®‰è£…
pip install -r requirements.txt
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»º .env æ–‡ä»¶

```bash
# Linux/Mac
cp env.example .env

# Windows
copy env.example .env
```

### 2. ç¼–è¾‘ .env æ–‡ä»¶

```bash
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„å®é™…é…ç½®
nano .env  # æˆ–ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨
```

ç¤ºä¾‹å†…å®¹ï¼š

```ini
# QMTæœåŠ¡å™¨åœ°å€
QMT_BASE_URL=http://192.168.77.169:9091

# APIè®¤è¯ä¿¡æ¯
QMT_CLIENT_ID=outer
QMT_SECRET_KEY=cornbear

# é»˜è®¤äº¤æ˜“å™¨ç´¢å¼•
QMT_TRADER_INDEX=0

# è¯·æ±‚è¶…æ—¶æ—¶é—´
QMT_TIMEOUT=30
```

### 3. ä½¿ç”¨å®¢æˆ·ç«¯

```python
from qmt_trade_client import QMTTradeClient

# âœ¨ è‡ªåŠ¨ä» .env æ–‡ä»¶è¯»å–æ‰€æœ‰é…ç½®
client = QMTTradeClient()

# å¼€å§‹äº¤æ˜“
portfolio = client.get_portfolio()
print(f"æ€»èµ„äº§: {portfolio['total_asset']}")
```

å°±è¿™ä¹ˆç®€å•ï¼ğŸ‰

---

## ğŸ“‹ æ”¯æŒçš„ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…éœ€ |
|---------|------|-------|------|
| `QMT_BASE_URL` | QMTæœåŠ¡å™¨åœ°å€ | http://localhost:9091 | å¦ |
| `QMT_CLIENT_ID` | APIå®¢æˆ·ç«¯ID | æ—  | ç­¾åè®¤è¯æ—¶å¿…éœ€ |
| `QMT_SECRET_KEY` | APIå¯†é’¥ | æ—  | ç­¾åè®¤è¯æ—¶å¿…éœ€ |
| `QMT_TRADER_INDEX` | é»˜è®¤äº¤æ˜“å™¨ç´¢å¼• | 0 | å¦ |
| `QMT_TIMEOUT` | è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | 30 | å¦ |

---

## ğŸ’¡ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: å®Œå…¨ä½¿ç”¨ .envï¼ˆæ¨èï¼‰

```python
from qmt_trade_client import QMTTradeClient

# æ‰€æœ‰å‚æ•°ä» .env æ–‡ä»¶è¯»å–
client = QMTTradeClient()
```

**ä¼˜ç‚¹**:
- ä»£ç æœ€ç®€æ´
- é…ç½®é›†ä¸­ç®¡ç†
- æ˜“äºç»´æŠ¤

### æ–¹å¼2: .env + æ‰‹åŠ¨è¦†ç›–

```python
from qmt_trade_client import QMTTradeClient

# å¤§éƒ¨åˆ†å‚æ•°ä» .env è¯»å–ï¼Œåªè¦†ç›– trader_index
client = QMTTradeClient(trader_index=1)

# æˆ–è€…è¦†ç›–å¤šä¸ªå‚æ•°
client = QMTTradeClient(
    base_url="http://other-server:9091",  # è¦†ç›– base_url
    trader_index=1  # è¦†ç›– trader_index
    # client_id å’Œ secret_key ä» .env è¯»å–
)
```

**ä¼˜ç‚¹**:
- çµæ´»æ€§é«˜
- å¯ä¸´æ—¶è°ƒæ•´å‚æ•°

### æ–¹å¼3: å®Œå…¨æ‰‹åŠ¨æŒ‡å®šï¼ˆå…¼å®¹æ—§ä»£ç ï¼‰

```python
from qmt_trade_client import QMTTradeClient

# ä¸ä½¿ç”¨ .env æ–‡ä»¶
client = QMTTradeClient(
    base_url="http://localhost:9091",
    client_id="your_client_id",
    secret_key="your_secret_key",
    trader_index=0,
    env_file=None  # ç¦ç”¨ .env æ–‡ä»¶åŠ è½½
)
```

**ä¼˜ç‚¹**:
- å®Œå…¨æ§åˆ¶
- å‘åå…¼å®¹

### æ–¹å¼4: æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶

```python
from qmt_trade_client import QMTTradeClient

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
client = QMTTradeClient(env_file=".env.production")

# æˆ–åœ¨ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®
import os
env_name = os.getenv("ENV", "development")
client = QMTTradeClient(env_file=f".env.{env_name}")
```

**ä¼˜ç‚¹**:
- æ”¯æŒå¤šç¯å¢ƒ
- çµæ´»é…ç½®

---

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. ä¸è¦æäº¤ .env æ–‡ä»¶

ç¡®ä¿ `.gitignore` åŒ…å« `.env`ï¼š

```gitignore
# .gitignore
.env
.env.*
!.env.example
!env.example
```

### 2. ä½¿ç”¨ env.example ä½œä¸ºæ¨¡æ¿

æäº¤ `env.example` ä½œä¸ºé…ç½®æ¨¡æ¿ï¼Œä½†ä¸åŒ…å«çœŸå®å¯†é’¥ï¼š

```bash
# å›¢é˜Ÿæˆå‘˜å¯ä»¥è¿™æ ·å¼€å§‹
cp env.example .env
# ç„¶åå¡«å…¥è‡ªå·±çš„å¯†é’¥
```

### 3. å®šæœŸè½®æ¢å¯†é’¥

å»ºè®®å®šæœŸæ›´æ¢ API å¯†é’¥ï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚

### 4. é™åˆ¶æ–‡ä»¶æƒé™

```bash
# Linux/Mac: åªæœ‰å½“å‰ç”¨æˆ·å¯è¯»
chmod 600 .env
```

---

## ğŸ“‚ æ–‡ä»¶ç»“æ„ç¤ºä¾‹

```
qmt_trader_http_server/
â”œâ”€â”€ .env                    # æœ¬åœ°é…ç½®ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ env.example             # é…ç½®æ¨¡æ¿ï¼ˆæäº¤ï¼‰
â”œâ”€â”€ qmt_trade_client.py     # å®¢æˆ·ç«¯ä»£ç 
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ simple_trade.py     # ç¤ºä¾‹ä»£ç 
â””â”€â”€ .gitignore              # å¿½ç•¥ .env æ–‡ä»¶
```

---

## ğŸ”„ å‚æ•°ä¼˜å…ˆçº§

é…ç½®å‚æ•°çš„ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

1. **ç›´æ¥ä¼ å…¥å‚æ•°** - æœ€é«˜ä¼˜å…ˆçº§
2. **ç¯å¢ƒå˜é‡ï¼ˆ.env æ–‡ä»¶ï¼‰** - ä¸­ç­‰ä¼˜å…ˆçº§
3. **é»˜è®¤å€¼** - æœ€ä½ä¼˜å…ˆçº§

ç¤ºä¾‹ï¼š

```python
# .env æ–‡ä»¶å†…å®¹
QMT_BASE_URL=http://server1:9091
QMT_TRADER_INDEX=0

# Python ä»£ç 
client = QMTTradeClient(
    base_url="http://server2:9091",  # è¦†ç›– .env ä¸­çš„è®¾ç½®
    trader_index=1  # è¦†ç›– .env ä¸­çš„è®¾ç½®
)

# å®é™…ä½¿ç”¨çš„å€¼ï¼š
# base_url = "http://server2:9091"  (æ¥è‡ªå‚æ•°)
# trader_index = 1  (æ¥è‡ªå‚æ•°)
```

---

## ğŸŒ å¤šç¯å¢ƒé…ç½®

### å¼€å‘ç¯å¢ƒ

`.env.development`ï¼š
```ini
QMT_BASE_URL=http://localhost:9091
QMT_CLIENT_ID=dev_client
QMT_SECRET_KEY=dev_secret
QMT_TRADER_INDEX=0
```

### æµ‹è¯•ç¯å¢ƒ

`.env.testing`ï¼š
```ini
QMT_BASE_URL=http://test-server:9091
QMT_CLIENT_ID=test_client
QMT_SECRET_KEY=test_secret
QMT_TRADER_INDEX=0
```

### ç”Ÿäº§ç¯å¢ƒ

`.env.production`ï¼š
```ini
QMT_BASE_URL=http://prod-server:9091
QMT_CLIENT_ID=prod_client
QMT_SECRET_KEY=prod_secret
QMT_TRADER_INDEX=0
```

### ä½¿ç”¨æ–¹å¼

```python
import os
from qmt_trade_client import QMTTradeClient

# æ ¹æ®ç¯å¢ƒå˜é‡é€‰æ‹©é…ç½®æ–‡ä»¶
env = os.getenv("APP_ENV", "development")
client = QMTTradeClient(env_file=f".env.{env}")
```

æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š

```bash
# Linux/Mac
export APP_ENV=production
python your_script.py

# Windows
set APP_ENV=production
python your_script.py
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: .env æ–‡ä»¶ä¸ç”Ÿæ•ˆï¼Ÿ

**è§£å†³æ–¹æ³•**:
1. ç¡®è®¤ .env æ–‡ä»¶åœ¨å½“å‰å·¥ä½œç›®å½•
2. æ£€æŸ¥æ–‡ä»¶å†…å®¹æ ¼å¼æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤å·²å®‰è£… python-dotenv

```bash
# æ£€æŸ¥æ˜¯å¦å®‰è£…
pip show python-dotenv

# å¦‚æœªå®‰è£…
pip install python-dotenv
```

### Q2: å¦‚ä½•æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„é…ç½®ï¼Ÿ

```python
client = QMTTradeClient()

print(f"Base URL: {client.base_url}")
print(f"Client ID: {client.client_id}")
print(f"Trader Index: {client.trader_index}")
print(f"Timeout: {client.timeout}")
```

### Q3: å¦‚ä½•åœ¨ä¸åŒç›®å½•ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Ÿ

```python
from pathlib import Path

# æ–¹å¼1: æŒ‡å®šç»å¯¹è·¯å¾„
config_path = Path("/path/to/your/.env")
client = QMTTradeClient(env_file=str(config_path))

# æ–¹å¼2: ç›¸å¯¹äºè„šæœ¬ç›®å½•
script_dir = Path(__file__).parent
config_path = script_dir / ".env"
client = QMTTradeClient(env_file=str(config_path))
```

### Q4: å¦‚ä½•å®Œå…¨ç¦ç”¨ .env æ–‡ä»¶ï¼Ÿ

```python
# è®¾ç½® env_file=None
client = QMTTradeClient(
    base_url="http://localhost:9091",
    client_id="xxx",
    secret_key="xxx",
    env_file=None  # ä¸åŠ è½½ä»»ä½• .env æ–‡ä»¶
)
```

### Q5: æœªå®‰è£… python-dotenv ä¼šæ€æ ·ï¼Ÿ

å¦‚æœæœªå®‰è£… `python-dotenv`ï¼Œå®¢æˆ·ç«¯ä¼šï¼š
1. æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
2. ç»§ç»­è¿è¡Œï¼ˆä¸ä¼šæŠ¥é”™ï¼‰
3. åªèƒ½ä½¿ç”¨æ‰‹åŠ¨ä¼ å…¥çš„å‚æ•°æˆ–é»˜è®¤å€¼

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [QMT_CLIENT_ä½¿ç”¨æ‰‹å†Œ.md](QMT_CLIENT_ä½¿ç”¨æ‰‹å†Œ.md) - å®Œæ•´ä½¿ç”¨æŒ‡å—
- [QMTå®¢æˆ·ç«¯ä¼˜åŒ–è¯´æ˜.md](QMTå®¢æˆ·ç«¯ä¼˜åŒ–è¯´æ˜.md) - ä¼˜åŒ–è¯´æ˜
- [env.example](env.example) - é…ç½®æ–‡ä»¶æ¨¡æ¿

---

## ğŸ‰ æ€»ç»“

ä½¿ç”¨ .env é…ç½®çš„ä¼˜åŠ¿ï¼š

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹å¼ | .env æ–¹å¼ |
|-----|---------|----------|
| å®‰å…¨æ€§ | âš ï¸ ä»£ç ä¸­æœ‰å¯†é’¥ | âœ… å¯†é’¥ç‹¬ç«‹ç®¡ç† |
| çµæ´»æ€§ | âŒ ä¿®æ”¹éœ€æ”¹ä»£ç  | âœ… ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ |
| å¤šç¯å¢ƒ | âŒ éœ€è¦å¤šä»½ä»£ç  | âœ… å¤šä»½é…ç½®æ–‡ä»¶ |
| ç‰ˆæœ¬æ§åˆ¶ | âš ï¸ å¯èƒ½æ³„éœ²å¯†é’¥ | âœ… å¯†é’¥ä¸æäº¤ |
| æ˜“ç”¨æ€§ | âš ï¸ å‚æ•°ç¹ç | âœ… ä¸€æ¬¡é…ç½® |

**æ¨èä½¿ç”¨ .env é…ç½®æ–¹å¼ï¼** ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024å¹´10æœˆ16æ—¥  
**ä½œè€…**: QMTäº¤æ˜“ç³»ç»Ÿå¼€å‘å›¢é˜Ÿ

